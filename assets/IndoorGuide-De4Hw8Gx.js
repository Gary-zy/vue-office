import{d as Y,c as d,o as a,a as l,H as Ce,b as Fe,e as z,q as c,x as $e,s as ze,f as T,w as i,g as f,h as Te,r as p,j as n,y as Re,l as V,k as h,F as C,m as F,t as y,aw as Be,ax as Oe,p as Le,n as X,z as E,$ as Me}from"./index-Iy6KDkAz.js";import{Q as Se}from"./browser-Ce9yiuwm.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as De}from"./SearchOutline-DjR0BbGZ.js";import{A as qe}from"./AddOutline-BDwBNPv2.js";import{a as Ne,C as je}from"./ChevronUpOutline-iPIkwFoQ.js";const Qe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ue=Y({name:"RefreshOutline",render:function(x,b){return a(),d("svg",Qe,b[0]||(b[0]=[l("path",{d:"M320 146s24.36-12-64-12a160 160 0 1 0 160 160",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32"},null,-1),l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 58l80 80l-80 80"},null,-1)]))}}),Ve={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ee=Y({name:"RemoveOutline",render:function(x,b){return a(),d("svg",Ve,b[0]||(b[0]=[l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M400 256H112"},null,-1)]))}}),He=[{id:"building-1",name:"Ëá™ÁÑ∂ÂçöÁâ©È¶Ü",description:"Â±ïÁ§∫Ëá™ÁÑ∂ÂéÜÂè≤ÂíåÁßëÂ≠¶Áü•ËØÜÁöÑÁªºÂêàÊÄßÂçöÁâ©È¶Ü",floors:[{id:"floor-2",name:"F2",level:2,title:"‰∫åÂ±ÇÂ±ïÂéÖ",svg:{width:800,height:600,viewBox:"0 0 800 600"},rooms:[{id:"room-1",name:"ÁåõÁä∏Ë±°Â±ïÂéÖ",type:"exhibition",x:100,y:150,width:180,height:120,description:"Â±ïÁ§∫ÁåõÁä∏Ë±°ÂåñÁü≥ÂíåÂ§çÂéüÊ®°Âûã",exhibits:["ÁåõÁä∏Ë±°È™®Êû∂","ÁåõÁä∏Ë±°Â§çÂéüÊ®°Âûã","ÂÜ∞Ê≤≥Êó∂‰ª£Â±ïÂìÅ"]},{id:"room-2",name:"ÊûóÁì£ËπºÈπ¨Â±ïÂå∫",type:"exhibition",x:320,y:150,width:150,height:120,description:"Â±ïÁ§∫ÂêÑÁßçÈ∏üÁ±ªÊ†áÊú¨",exhibits:["ÊûóÁì£ËπºÈπ¨Ê†áÊú¨","È∏üÁ±ªËøõÂåñÂè≤"]},{id:"room-3",name:"Ê†ºÈôµÂÖ∞È©ØÈπø",type:"exhibition",x:500,y:150,width:160,height:120,description:"ÊûÅÂú∞Âä®Áâ©Â±ïÁ§∫Âå∫",exhibits:["È©ØÈπøÊ†áÊú¨","ÊûÅÂú∞ÁîüÊÄÅ"]},{id:"room-4",name:"ÂçóÊûÅÁãºÂ±ïÂå∫",type:"exhibition",x:100,y:300,width:170,height:130,description:"Â±ïÁ§∫Â∑≤ÁÅ≠ÁªùÁöÑÂçóÊûÅÁãº",exhibits:["ÂçóÊûÅÁãºÊ†áÊú¨","ÁÅ≠ÁªùÂä®Áâ©Â±ï"]},{id:"room-5",name:"Â§±ËêΩÁöÑ‰∏ñÁïå",type:"exhibition",x:300,y:300,width:200,height:130,description:"Â±ïÁ§∫Âè≤ÂâçÁîüÁâ©",exhibits:["ÊÅêÈæôÂåñÁü≥","Âè≤ÂâçÊ§çÁâ©","Âè§ÁîüÁâ©Ê®°Âûã"]},{id:"room-6",name:"ÈòøÁâπÊãâÊñØÊ£ïÁÜä",type:"exhibition",x:530,y:300,width:150,height:130,description:"Â§ßÂûãÂì∫‰π≥Âä®Áâ©Â±ïÂå∫",exhibits:["Ê£ïÁÜäÊ†áÊú¨","Âì∫‰π≥Âä®Áâ©ËøõÂåñ"]}],facilities:[{id:"facility-1",name:"Ê¥óÊâãÈó¥",type:"restroom",x:50,y:50,icon:"üöª"},{id:"facility-2",name:"Êó†ÈöúÁ¢çÂç´ÁîüÈó¥",type:"accessible-restroom",x:50,y:100,icon:"‚ôø"},{id:"facility-3",name:"ÊâãÊâ∂ÁîµÊ¢Ø",type:"escalator",x:700,y:200,icon:"‚¨ÜÔ∏è"},{id:"facility-4",name:"ÁîµÊ¢Ø",type:"elevator",x:700,y:300,icon:"üõó"},{id:"facility-5",name:"Âá∫ÂÖ•Âè£",type:"entrance",x:700,y:500,icon:"üö™"}],corridors:[{id:"corridor-1",points:[{x:280,y:150},{x:280,y:430}],width:40},{id:"corridor-2",points:[{x:100,y:210},{x:680,y:210}],width:40},{id:"corridor-3",points:[{x:100,y:360},{x:680,y:360}],width:40}]},{id:"floor-1",name:"F1",level:1,title:"‰∏ÄÂ±ÇÂ±ïÂéÖ",svg:{width:800,height:600,viewBox:"0 0 800 600"},rooms:[{id:"room-7",name:"ÊñëÈ©¥Â±ïÂå∫",type:"exhibition",x:120,y:100,width:160,height:140,description:"Â±ïÁ§∫Â∑≤ÁÅ≠ÁªùÁöÑÊñëÈ©¥",exhibits:["ÊñëÈ©¥Ê†áÊú¨","ÈùûÊ¥≤Âä®Áâ©"]},{id:"room-8",name:"È©¨ÁæöÂ±ïÂå∫",type:"exhibition",x:320,y:100,width:150,height:140,description:"ÈùûÊ¥≤ËçâÂéüÂä®Áâ©",exhibits:["È©¨ÁæöÊ†áÊú¨","ËçâÂéüÁîüÊÄÅ"]},{id:"room-9",name:"Êó•Êú¨Êµ∑ÁãÆ",type:"exhibition",x:500,y:100,width:160,height:140,description:"Êµ∑Ê¥ãÂì∫‰π≥Âä®Áâ©Â±ïÂå∫",exhibits:["Êµ∑ÁãÆÊ†áÊú¨","Êµ∑Ê¥ãÁîüÁâ©"]},{id:"room-10",name:"Ê∏∏ÂÆ¢‰∏≠ÂøÉ",type:"info",x:120,y:280,width:120,height:100,description:"Êèê‰æõÂí®ËØ¢ÊúçÂä°"},{id:"room-11",name:"Á∫™ÂøµÂìÅÂïÜÂ∫ó",type:"shop",x:280,y:280,width:140,height:100,description:"Ë¥≠‰π∞Á∫™ÂøµÂìÅ"},{id:"room-12",name:"ÂíñÂï°ÂéÖ",type:"restaurant",x:460,y:280,width:140,height:100,description:"‰ºëÊÅØÂíåÁî®È§ê"}],facilities:[{id:"facility-6",name:"Ê¥óÊâãÈó¥",type:"restroom",x:50,y:50,icon:"üöª"},{id:"facility-7",name:"ÁîµÊ¢Ø",type:"elevator",x:700,y:200,icon:"üõó"},{id:"facility-8",name:"‰∏ªÂÖ•Âè£",type:"entrance",x:700,y:500,icon:"üö™"}],corridors:[{id:"corridor-4",points:[{x:280,y:100},{x:280,y:380}],width:40},{id:"corridor-5",points:[{x:120,y:240},{x:600,y:240}],width:40}]},{id:"floor-b1",name:"B1",level:-1,title:"Âú∞‰∏ã‰∏ÄÂ±Ç",svg:{width:800,height:600,viewBox:"0 0 800 600"},rooms:[{id:"room-13",name:"Âú∞ÈúáÊ≥¢ÁöÑ‰º†Êí≠",type:"exhibition",x:100,y:100,width:200,height:150,description:"Âú∞ÈúáÁßëÂ≠¶Â±ïÂå∫",exhibits:["Âú∞ÈúáÊ®°ÊãüÂô®","Âú∞ÈúáÊ≥¢ÊºîÁ§∫"]},{id:"room-14",name:"Âú∞ÁêÉÁöÑ‰ΩéÂêü",type:"exhibition",x:340,y:100,width:200,height:150,description:"Âú∞ÁêÉÁßëÂ≠¶Â±ïÂå∫",exhibits:["Âú∞ÁêÉÊ®°Âûã","Âú∞Ë¥®Â±ïÂìÅ"]},{id:"room-15",name:"Âç±ÂåñÂìÅÂÆâÂÖ®",type:"exhibition",x:100,y:300,width:180,height:150,description:"ÂÆâÂÖ®ÁßëÊôÆÂ±ïÂå∫",exhibits:["ÂÆâÂÖ®Áü•ËØÜ","Â∫îÊÄ•ÊºîÁªÉ"]},{id:"room-16",name:"Èáç‰∫éÊ≥∞Â±±",type:"exhibition",x:320,y:300,width:200,height:150,description:"ÂÆâÂÖ®ÊïôËÇ≤Â±ïÂå∫",exhibits:["ÂÆâÂÖ®Ê°à‰æã","È¢ÑÈò≤Êé™ÊñΩ"]}],facilities:[{id:"facility-9",name:"Ê¥óÊâãÈó¥",type:"restroom",x:50,y:50,icon:"üöª"},{id:"facility-10",name:"ÁîµÊ¢Ø",type:"elevator",x:700,y:200,icon:"üõó"}],corridors:[{id:"corridor-6",points:[{x:300,y:100},{x:300,y:450}],width:40}]}]}],Ke={restroom:{label:"Ê¥óÊâãÈó¥",icon:"üöª",color:"#1890ff"},"accessible-restroom":{label:"Êó†ÈöúÁ¢çÂç´ÁîüÈó¥",icon:"‚ôø",color:"#52c41a"},escalator:{label:"ÊâãÊâ∂ÁîµÊ¢Ø",icon:"‚¨ÜÔ∏è",color:"#faad14"},elevator:{label:"ÁîµÊ¢Ø",icon:"üõó",color:"#722ed1"},entrance:{label:"Âá∫ÂÖ•Âè£",icon:"üö™",color:"#eb2f96"}},Ae={exhibition:{label:"Â±ïÂéÖ",color:"#52c41a",fill:"#f6ffed"},info:{label:"Ê∏∏ÂÆ¢‰∏≠ÂøÉ",color:"#1890ff",fill:"#e6f7ff"},shop:{label:"ÂïÜÂ∫ó",color:"#faad14",fill:"#fffbe6"},restaurant:{label:"È§êÂéÖ",color:"#eb2f96",fill:"#fff0f6"}},H={buildings:He,facilityTypes:Ke,roomTypes:Ae},Ge={class:"indoor-guide-page"},Ze={class:"guide-container"},Je={class:"search-header"},Pe={class:"quick-facilities"},We={style:{"font-size":"16px"}},Xe={class:"main-content"},Ye={class:"left-panel"},et=["width","height","viewBox"],tt=["points","stroke","stroke-width"],ot=["x","y","width","height","fill","stroke","onClick"],it=["x","y","fill"],nt=["cx","cy","fill","stroke","onClick"],lt=["x","y","fill"],st=["x","y","fill"],at={class:"zoom-controls"},rt={class:"floor-selector"},ct={class:"floor-list"},dt={key:0},ut={style:{"text-align":"center",padding:"20px"}},pt={__name:"IndoorGuide",setup(K){const x=Ce(),b=Fe(),I=z(()=>b.isDark),ee=c(H.buildings),B=c(H.facilityTypes),D=c(H.roomTypes),k=z(()=>ee.value[0]),g=c(0),m=z(()=>k.value?.floors[g.value]),w=c(""),A=c([]),u=c(null),_=c(null),q=c(!1),O=c(!1),N=c(!0),$=c(1),te=c(600),G=c(null),j=c(null),oe=z(()=>Object.values(B.value).map(t=>({...t,type:Object.keys(B.value).find(o=>B.value[o]===t)}))),ie=z(()=>{let t=m.value?.rooms||[];if(w.value){const o=w.value.toLowerCase();t=t.filter(s=>s.name.toLowerCase().includes(o)||s.description?.toLowerCase().includes(o)||s.exhibits?.some(r=>r.toLowerCase().includes(o)))}return t}),ne=z(()=>{let t=m.value?.facilities||[];return _.value&&(t=t.filter(o=>o.type===_.value)),t}),Z=t=>{const o=k.value.floors.length-1,s=g.value+t;s>=0&&s<=o&&(g.value=s,u.value=null,x.success(`Â∑≤ÂàáÊç¢Âà∞${m.value.name}`))},le=t=>{g.value=t,u.value=null,x.success(`Â∑≤ÂàáÊç¢Âà∞${m.value.name}`)},se=t=>{u.value=t,q.value=!0,x.info(`Â∑≤ÈÄâÊã©Ôºö${t.name}`)},ae=t=>{x.info(`Â∑≤ÂÆö‰ΩçÔºö${t.name}`)},re=t=>{_.value===t?_.value=null:_.value=t},ce=()=>{if(!w.value)return;const t=w.value.toLowerCase(),o=[];if(k.value.floors.forEach(s=>{s.rooms.forEach(r=>{(r.name.toLowerCase().includes(t)||r.description?.toLowerCase().includes(t)||r.exhibits?.some(R=>R.toLowerCase().includes(t)))&&o.push({...r,floor:s.name})})}),A.value=o,o.length>0){const s=o[0],r=k.value.floors.findIndex(R=>R.name===s.floor);r!==-1&&(g.value=r,x.success(`ÊâæÂà∞ ${o.length} ‰∏™ÁªìÊûú`))}else x.warning("Êú™ÊâæÂà∞Áõ∏ÂÖ≥Â±ïÂìÅ")},de=()=>{w.value="",A.value=[],_.value=null},ue=t=>{(t.target.tagName==="svg"||t.target.tagName==="g")&&(u.value=null)},pe=t=>{const o=D.value[t];return I.value?o?.fill.replace("#","#33")||"#333":o?.fill||"#f0f0f0"},J=t=>D.value[t]?.color||"#666",L=t=>B.value[t]?.color||"#1890ff",he=t=>D.value[t]?.label||t,me=t=>({exhibition:"success",info:"info",shop:"warning",restaurant:"error"})[t]||"default",ye=()=>{$.value=Math.min($.value+.1,2),Q()},ve=()=>{$.value=Math.max($.value-.1,.5),Q()},fe=()=>{$.value=1,Q()},Q=()=>{const t=G.value?.querySelector(".floor-svg");t&&(t.style.transform=`scale(${$.value})`,t.style.transformOrigin="center center")},xe=async()=>{if(j.value)try{await Se.toCanvas(j.value,"https://museum.example.com/audio-guide/123",{width:200,margin:2,color:{dark:"#000000",light:"#FFFFFF"}})}catch(t){console.error("ÁîüÊàê‰∫åÁª¥Á†ÅÂ§±Ë¥•:",t)}};return $e(O,t=>{t&&Me(()=>{xe()})}),ze(()=>{k.value?.floors.length>0&&(g.value=0)}),(t,o)=>{const s=p("n-icon"),r=p("n-button"),R=p("n-input"),ge=p("n-scrollbar"),M=p("n-descriptions-item"),P=p("n-tag"),U=p("n-space"),we=p("n-descriptions"),W=p("n-modal"),_e=p("n-alert"),be=p("n-text"),ke=p("n-config-provider");return a(),T(ke,{theme:I.value?f(Te):null},{default:i(()=>[l("div",Ge,[l("div",Ze,[l("div",Je,[n(R,{value:w.value,"onUpdate:value":o[0]||(o[0]=e=>w.value=e),placeholder:"ËØ∑ËæìÂÖ•ÊêúÁ¥¢ÂÖ≥ÈîÆËØç",clearable:"",onKeyup:Re(ce,["enter"])},{prefix:i(()=>[n(s,{component:f(De)},null,8,["component"])]),suffix:i(()=>[w.value?(a(),T(r,{key:0,text:"",onClick:de},{default:i(()=>[...o[7]||(o[7]=[h(" ÂèñÊ∂à ",-1)])]),_:1})):V("",!0)]),_:1},8,["value"])]),l("div",Pe,[(a(!0),d(C,null,F(oe.value,e=>(a(),T(r,{key:e.type,type:_.value===e.type?"primary":"default",size:"small",onClick:v=>re(e.type)},{icon:i(()=>[l("span",We,y(e.icon),1)]),default:i(()=>[h(" "+y(e.label),1)]),_:2},1032,["type","onClick"]))),128))]),l("div",Xe,[l("div",Ye,[n(r,{text:"",class:"scan-button",onClick:o[1]||(o[1]=e=>O.value=!0)},{icon:i(()=>[n(s,{component:f(Be)},null,8,["component"])]),default:i(()=>[o[8]||(o[8]=h(" Êâ´Á†ÅËÆ≤Ëß£ ",-1))]),_:1}),n(r,{text:"",type:N.value?"primary":"default",class:"map-button",onClick:o[2]||(o[2]=e=>N.value=!N.value)},{icon:i(()=>[n(s,{component:f(Oe)},null,8,["component"])]),default:i(()=>[o[9]||(o[9]=h(" Âú∞ÂõæÂØºËßà ",-1))]),_:1},8,["type"])]),l("div",{class:"floor-map-container",ref_key:"mapContainer",ref:G},[l("div",{class:"floor-map-wrapper",style:Le({height:te.value+"px"})},[(a(),d("svg",{width:m.value?.svg.width||800,height:m.value?.svg.height||600,viewBox:m.value?.svg.viewBox||"0 0 800 600",class:"floor-svg",onClick:ue},[(a(!0),d(C,null,F(m.value?.corridors,e=>(a(),d("g",{key:e.id},[(a(!0),d(C,null,F(e.points.slice(1),(v,S)=>(a(),d("polyline",{key:S,points:`${e.points[S].x},${e.points[S].y} ${v.x},${v.y}`,stroke:I.value?"#666":"#ddd","stroke-width":e.width,fill:"none","stroke-linecap":"round"},null,8,tt))),128))]))),128)),(a(!0),d(C,null,F(ie.value,e=>(a(),d("g",{key:e.id},[l("rect",{x:e.x,y:e.y,width:e.width,height:e.height,fill:pe(e.type),stroke:J(e.type),"stroke-width":"2",class:E({"room-highlight":u.value?.id===e.id}),onClick:X(v=>se(e),["stop"]),style:{cursor:"pointer"}},null,10,ot),l("text",{x:e.x+e.width/2,y:e.y+e.height/2,"text-anchor":"middle","dominant-baseline":"middle",fill:J(e.type),"font-size":"14","font-weight":"bold","pointer-events":"none"},y(e.name),9,it)]))),128)),(a(!0),d(C,null,F(ne.value,e=>(a(),d("g",{key:e.id},[l("circle",{cx:e.x,cy:e.y,r:"15",fill:L(e.type),stroke:L(e.type),"stroke-width":"2",class:E({"facility-highlight":_.value===e.type}),onClick:X(v=>ae(e),["stop"]),style:{cursor:"pointer"}},null,10,nt),l("text",{x:e.x,y:e.y-25,"text-anchor":"middle",fill:L(e.type),"font-size":"18","pointer-events":"none"},y(e.icon),9,lt),l("text",{x:e.x,y:e.y+5,"text-anchor":"middle",fill:L(e.type),"font-size":"10","font-weight":"bold","pointer-events":"none"},y(e.name),9,st)]))),128))],8,et)),l("div",at,[n(r,{size:"small",onClick:ye},{icon:i(()=>[n(s,{component:f(qe)},null,8,["component"])]),_:1}),n(r,{size:"small",onClick:ve},{icon:i(()=>[n(s,{component:f(Ee)},null,8,["component"])]),_:1}),n(r,{size:"small",onClick:fe},{icon:i(()=>[n(s,{component:f(Ue)},null,8,["component"])]),_:1})])],4)],512),l("div",rt,[n(r,{text:"",size:"small",disabled:g.value===0,onClick:o[3]||(o[3]=e=>Z(-1))},{icon:i(()=>[n(s,{component:f(Ne)},null,8,["component"])]),_:1},8,["disabled"]),n(ge,{style:{"max-height":"400px"}},{default:i(()=>[l("div",ct,[(a(!0),d(C,null,F(k.value?.floors,(e,v)=>(a(),T(r,{key:e.id,type:m.value?.id===e.id?"primary":"default",class:E({"floor-active":m.value?.id===e.id}),onClick:S=>le(v),block:"",style:{"margin-bottom":"8px"}},{default:i(()=>[h(y(e.name),1)]),_:2},1032,["type","class","onClick"]))),128))])]),_:1}),n(r,{text:"",size:"small",disabled:g.value===(k.value?.floors.length||0)-1,onClick:o[4]||(o[4]=e=>Z(1))},{icon:i(()=>[n(s,{component:f(je)},null,8,["component"])]),_:1},8,["disabled"])])])]),n(W,{show:q.value,"onUpdate:show":o[5]||(o[5]=e=>q.value=e),preset:"card",style:{width:"600px"},title:"Â±ïÂå∫ËØ¶ÊÉÖ"},{default:i(()=>[u.value?(a(),d("div",dt,[n(U,{vertical:"",size:16},{default:i(()=>[n(we,{column:1,bordered:""},{default:i(()=>[n(M,{label:"ÂêçÁß∞"},{default:i(()=>[h(y(u.value.name),1)]),_:1}),n(M,{label:"Á±ªÂûã"},{default:i(()=>[n(P,{type:me(u.value.type)},{default:i(()=>[h(y(he(u.value.type)),1)]),_:1},8,["type"])]),_:1}),n(M,{label:"ÊèèËø∞"},{default:i(()=>[h(y(u.value.description),1)]),_:1}),u.value.exhibits?(a(),T(M,{key:0,label:"Â±ïÂìÅ"},{default:i(()=>[n(U,null,{default:i(()=>[(a(!0),d(C,null,F(u.value.exhibits,(e,v)=>(a(),T(P,{key:v,size:"small"},{default:i(()=>[h(y(e),1)]),_:2},1024))),128))]),_:1})]),_:1})):V("",!0)]),_:1})]),_:1})])):V("",!0)]),_:1},8,["show"]),n(W,{show:O.value,"onUpdate:show":o[6]||(o[6]=e=>O.value=e),preset:"card",style:{width:"400px"},title:"Êâ´Á†ÅËÆ≤Ëß£"},{default:i(()=>[n(U,{vertical:"",size:16},{default:i(()=>[n(_e,{type:"info"},{default:i(()=>[...o[10]||(o[10]=[h(" ËØ∑‰ΩøÁî®ÊâãÊú∫Êâ´ÊèèÂ±ïÂìÅÊóÅÁöÑ‰∫åÁª¥Á†ÅÔºåÂç≥ÂèØÊî∂Âê¨ËØ≠Èü≥ËÆ≤Ëß£„ÄÇ ",-1)])]),_:1}),l("div",ut,[l("canvas",{ref_key:"qrCodeCanvas",ref:j,style:{display:"inline-block"}},null,512),n(be,{depth:"3",style:{display:"block","margin-top":"12px"}},{default:i(()=>[...o[11]||(o[11]=[h(" Á§∫‰æã‰∫åÁª¥Á†Å ",-1)])]),_:1})])]),_:1})]),_:1},8,["show"])])]),_:1},8,["theme"])}}},gt=Ie(pt,[["__scopeId","data-v-82abd941"]]);export{gt as default};
