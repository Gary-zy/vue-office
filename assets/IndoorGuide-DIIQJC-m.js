import{d as ke,c as d,o as a,a as r,L as Ce,b as z,q as c,y as Fe,e as ze,s as T,w as i,i as f,H as Te,r as p,h as n,z as $e,x as V,p as h,F as k,j as C,t as y,au as Re,av as Be,n as Oe,aw as W,A,a2 as Le}from"./index-0AdF0WFe.js";import{u as Se}from"./theme-BXB3iaSC.js";import{Q as Ie}from"./browser-EBqNHL6N.js";import{_ as Me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as De}from"./SearchOutline-Bw98dWMI.js";import{A as qe}from"./AddOutline-PEIy7obg.js";import{R as Ne}from"./RefreshOutline-Dr-3KmOy.js";import{C as je}from"./ChevronUpOutline-CHXRAcrf.js";import{C as Qe}from"./ChevronDownOutline-DEaZbj5B.js";const Ue={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ve=ke({name:"RemoveOutline",render:function(w,R){return a(),d("svg",Ue,R[0]||(R[0]=[r("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M400 256H112"},null,-1)]))}}),Ae=[{id:"building-1",name:"Ëá™ÁÑ∂ÂçöÁâ©È¶Ü",description:"Â±ïÁ§∫Ëá™ÁÑ∂ÂéÜÂè≤ÂíåÁßëÂ≠¶Áü•ËØÜÁöÑÁªºÂêàÊÄßÂçöÁâ©È¶Ü",floors:[{id:"floor-2",name:"F2",level:2,title:"‰∫åÂ±ÇÂ±ïÂéÖ",svg:{width:800,height:600,viewBox:"0 0 800 600"},rooms:[{id:"room-1",name:"ÁåõÁä∏Ë±°Â±ïÂéÖ",type:"exhibition",x:100,y:150,width:180,height:120,description:"Â±ïÁ§∫ÁåõÁä∏Ë±°ÂåñÁü≥ÂíåÂ§çÂéüÊ®°Âûã",exhibits:["ÁåõÁä∏Ë±°È™®Êû∂","ÁåõÁä∏Ë±°Â§çÂéüÊ®°Âûã","ÂÜ∞Ê≤≥Êó∂‰ª£Â±ïÂìÅ"]},{id:"room-2",name:"ÊûóÁì£ËπºÈπ¨Â±ïÂå∫",type:"exhibition",x:320,y:150,width:150,height:120,description:"Â±ïÁ§∫ÂêÑÁßçÈ∏üÁ±ªÊ†áÊú¨",exhibits:["ÊûóÁì£ËπºÈπ¨Ê†áÊú¨","È∏üÁ±ªËøõÂåñÂè≤"]},{id:"room-3",name:"Ê†ºÈôµÂÖ∞È©ØÈπø",type:"exhibition",x:500,y:150,width:160,height:120,description:"ÊûÅÂú∞Âä®Áâ©Â±ïÁ§∫Âå∫",exhibits:["È©ØÈπøÊ†áÊú¨","ÊûÅÂú∞ÁîüÊÄÅ"]},{id:"room-4",name:"ÂçóÊûÅÁãºÂ±ïÂå∫",type:"exhibition",x:100,y:300,width:170,height:130,description:"Â±ïÁ§∫Â∑≤ÁÅ≠ÁªùÁöÑÂçóÊûÅÁãº",exhibits:["ÂçóÊûÅÁãºÊ†áÊú¨","ÁÅ≠ÁªùÂä®Áâ©Â±ï"]},{id:"room-5",name:"Â§±ËêΩÁöÑ‰∏ñÁïå",type:"exhibition",x:300,y:300,width:200,height:130,description:"Â±ïÁ§∫Âè≤ÂâçÁîüÁâ©",exhibits:["ÊÅêÈæôÂåñÁü≥","Âè≤ÂâçÊ§çÁâ©","Âè§ÁîüÁâ©Ê®°Âûã"]},{id:"room-6",name:"ÈòøÁâπÊãâÊñØÊ£ïÁÜä",type:"exhibition",x:530,y:300,width:150,height:130,description:"Â§ßÂûãÂì∫‰π≥Âä®Áâ©Â±ïÂå∫",exhibits:["Ê£ïÁÜäÊ†áÊú¨","Âì∫‰π≥Âä®Áâ©ËøõÂåñ"]}],facilities:[{id:"facility-1",name:"Ê¥óÊâãÈó¥",type:"restroom",x:50,y:50,icon:"üöª"},{id:"facility-2",name:"Êó†ÈöúÁ¢çÂç´ÁîüÈó¥",type:"accessible-restroom",x:50,y:100,icon:"‚ôø"},{id:"facility-3",name:"ÊâãÊâ∂ÁîµÊ¢Ø",type:"escalator",x:700,y:200,icon:"‚¨ÜÔ∏è"},{id:"facility-4",name:"ÁîµÊ¢Ø",type:"elevator",x:700,y:300,icon:"üõó"},{id:"facility-5",name:"Âá∫ÂÖ•Âè£",type:"entrance",x:700,y:500,icon:"üö™"}],corridors:[{id:"corridor-1",points:[{x:280,y:150},{x:280,y:430}],width:40},{id:"corridor-2",points:[{x:100,y:210},{x:680,y:210}],width:40},{id:"corridor-3",points:[{x:100,y:360},{x:680,y:360}],width:40}]},{id:"floor-1",name:"F1",level:1,title:"‰∏ÄÂ±ÇÂ±ïÂéÖ",svg:{width:800,height:600,viewBox:"0 0 800 600"},rooms:[{id:"room-7",name:"ÊñëÈ©¥Â±ïÂå∫",type:"exhibition",x:120,y:100,width:160,height:140,description:"Â±ïÁ§∫Â∑≤ÁÅ≠ÁªùÁöÑÊñëÈ©¥",exhibits:["ÊñëÈ©¥Ê†áÊú¨","ÈùûÊ¥≤Âä®Áâ©"]},{id:"room-8",name:"È©¨ÁæöÂ±ïÂå∫",type:"exhibition",x:320,y:100,width:150,height:140,description:"ÈùûÊ¥≤ËçâÂéüÂä®Áâ©",exhibits:["È©¨ÁæöÊ†áÊú¨","ËçâÂéüÁîüÊÄÅ"]},{id:"room-9",name:"Êó•Êú¨Êµ∑ÁãÆ",type:"exhibition",x:500,y:100,width:160,height:140,description:"Êµ∑Ê¥ãÂì∫‰π≥Âä®Áâ©Â±ïÂå∫",exhibits:["Êµ∑ÁãÆÊ†áÊú¨","Êµ∑Ê¥ãÁîüÁâ©"]},{id:"room-10",name:"Ê∏∏ÂÆ¢‰∏≠ÂøÉ",type:"info",x:120,y:280,width:120,height:100,description:"Êèê‰æõÂí®ËØ¢ÊúçÂä°"},{id:"room-11",name:"Á∫™ÂøµÂìÅÂïÜÂ∫ó",type:"shop",x:280,y:280,width:140,height:100,description:"Ë¥≠‰π∞Á∫™ÂøµÂìÅ"},{id:"room-12",name:"ÂíñÂï°ÂéÖ",type:"restaurant",x:460,y:280,width:140,height:100,description:"‰ºëÊÅØÂíåÁî®È§ê"}],facilities:[{id:"facility-6",name:"Ê¥óÊâãÈó¥",type:"restroom",x:50,y:50,icon:"üöª"},{id:"facility-7",name:"ÁîµÊ¢Ø",type:"elevator",x:700,y:200,icon:"üõó"},{id:"facility-8",name:"‰∏ªÂÖ•Âè£",type:"entrance",x:700,y:500,icon:"üö™"}],corridors:[{id:"corridor-4",points:[{x:280,y:100},{x:280,y:380}],width:40},{id:"corridor-5",points:[{x:120,y:240},{x:600,y:240}],width:40}]},{id:"floor-b1",name:"B1",level:-1,title:"Âú∞‰∏ã‰∏ÄÂ±Ç",svg:{width:800,height:600,viewBox:"0 0 800 600"},rooms:[{id:"room-13",name:"Âú∞ÈúáÊ≥¢ÁöÑ‰º†Êí≠",type:"exhibition",x:100,y:100,width:200,height:150,description:"Âú∞ÈúáÁßëÂ≠¶Â±ïÂå∫",exhibits:["Âú∞ÈúáÊ®°ÊãüÂô®","Âú∞ÈúáÊ≥¢ÊºîÁ§∫"]},{id:"room-14",name:"Âú∞ÁêÉÁöÑ‰ΩéÂêü",type:"exhibition",x:340,y:100,width:200,height:150,description:"Âú∞ÁêÉÁßëÂ≠¶Â±ïÂå∫",exhibits:["Âú∞ÁêÉÊ®°Âûã","Âú∞Ë¥®Â±ïÂìÅ"]},{id:"room-15",name:"Âç±ÂåñÂìÅÂÆâÂÖ®",type:"exhibition",x:100,y:300,width:180,height:150,description:"ÂÆâÂÖ®ÁßëÊôÆÂ±ïÂå∫",exhibits:["ÂÆâÂÖ®Áü•ËØÜ","Â∫îÊÄ•ÊºîÁªÉ"]},{id:"room-16",name:"Èáç‰∫éÊ≥∞Â±±",type:"exhibition",x:320,y:300,width:200,height:150,description:"ÂÆâÂÖ®ÊïôËÇ≤Â±ïÂå∫",exhibits:["ÂÆâÂÖ®Ê°à‰æã","È¢ÑÈò≤Êé™ÊñΩ"]}],facilities:[{id:"facility-9",name:"Ê¥óÊâãÈó¥",type:"restroom",x:50,y:50,icon:"üöª"},{id:"facility-10",name:"ÁîµÊ¢Ø",type:"elevator",x:700,y:200,icon:"üõó"}],corridors:[{id:"corridor-6",points:[{x:300,y:100},{x:300,y:450}],width:40}]}]}],Ee={restroom:{label:"Ê¥óÊâãÈó¥",icon:"üöª",color:"#1890ff"},"accessible-restroom":{label:"Êó†ÈöúÁ¢çÂç´ÁîüÈó¥",icon:"‚ôø",color:"#52c41a"},escalator:{label:"ÊâãÊâ∂ÁîµÊ¢Ø",icon:"‚¨ÜÔ∏è",color:"#faad14"},elevator:{label:"ÁîµÊ¢Ø",icon:"üõó",color:"#722ed1"},entrance:{label:"Âá∫ÂÖ•Âè£",icon:"üö™",color:"#eb2f96"}},He={exhibition:{label:"Â±ïÂéÖ",color:"#52c41a",fill:"#f6ffed"},info:{label:"Ê∏∏ÂÆ¢‰∏≠ÂøÉ",color:"#1890ff",fill:"#e6f7ff"},shop:{label:"ÂïÜÂ∫ó",color:"#faad14",fill:"#fffbe6"},restaurant:{label:"È§êÂéÖ",color:"#eb2f96",fill:"#fff0f6"}},E={buildings:Ae,facilityTypes:Ee,roomTypes:He},Ke={class:"indoor-guide-page"},Ge={class:"guide-container"},Ze={class:"search-header"},Je={class:"quick-facilities"},Pe={style:{"font-size":"16px"}},We={class:"main-content"},Xe={class:"left-panel"},Ye=["width","height","viewBox"],et=["points","stroke","stroke-width"],tt=["x","y","width","height","fill","stroke","onClick"],ot=["x","y","fill"],it=["cx","cy","fill","stroke","onClick"],nt=["x","y","fill"],lt=["x","y","fill"],st={class:"zoom-controls"},at={class:"floor-selector"},rt={class:"floor-list"},ct={key:0},dt={style:{"text-align":"center",padding:"20px"}},ut={__name:"IndoorGuide",setup(X){const w=Ce(),R=Se(),M=z(()=>R.isDark),Y=c(E.buildings),B=c(E.facilityTypes),D=c(E.roomTypes),b=z(()=>Y.value[0]),x=c(0),m=z(()=>b.value?.floors[x.value]),g=c(""),H=c([]),u=c(null),_=c(null),q=c(!1),O=c(!1),N=c(!0),F=c(1),ee=c(600),K=c(null),j=c(null),te=z(()=>Object.values(B.value).map(t=>({...t,type:Object.keys(B.value).find(o=>B.value[o]===t)}))),oe=z(()=>{let t=m.value?.rooms||[];if(g.value){const o=g.value.toLowerCase();t=t.filter(l=>l.name.toLowerCase().includes(o)||l.description?.toLowerCase().includes(o)||l.exhibits?.some(s=>s.toLowerCase().includes(o)))}return t}),ie=z(()=>{let t=m.value?.facilities||[];return _.value&&(t=t.filter(o=>o.type===_.value)),t}),G=t=>{const o=b.value.floors.length-1,l=x.value+t;l>=0&&l<=o&&(x.value=l,u.value=null,w.success(`Â∑≤ÂàáÊç¢Âà∞${m.value.name}`))},ne=t=>{x.value=t,u.value=null,w.success(`Â∑≤ÂàáÊç¢Âà∞${m.value.name}`)},le=t=>{u.value=t,q.value=!0,w.info(`Â∑≤ÈÄâÊã©Ôºö${t.name}`)},se=t=>{w.info(`Â∑≤ÂÆö‰ΩçÔºö${t.name}`)},ae=t=>{_.value===t?_.value=null:_.value=t},re=()=>{if(!g.value)return;const t=g.value.toLowerCase(),o=[];if(b.value.floors.forEach(l=>{l.rooms.forEach(s=>{(s.name.toLowerCase().includes(t)||s.description?.toLowerCase().includes(t)||s.exhibits?.some($=>$.toLowerCase().includes(t)))&&o.push({...s,floor:l.name})})}),H.value=o,o.length>0){const l=o[0],s=b.value.floors.findIndex($=>$.name===l.floor);s!==-1&&(x.value=s,w.success(`ÊâæÂà∞ ${o.length} ‰∏™ÁªìÊûú`))}else w.warning("Êú™ÊâæÂà∞Áõ∏ÂÖ≥Â±ïÂìÅ")},ce=()=>{g.value="",H.value=[],_.value=null},de=t=>{(t.target.tagName==="svg"||t.target.tagName==="g")&&(u.value=null)},ue=t=>{const o=D.value[t];return M.value?o?.fill.replace("#","#33")||"#333":o?.fill||"#f0f0f0"},Z=t=>D.value[t]?.color||"#666",L=t=>B.value[t]?.color||"#1890ff",pe=t=>D.value[t]?.label||t,he=t=>({exhibition:"success",info:"info",shop:"warning",restaurant:"error"})[t]||"default",me=()=>{F.value=Math.min(F.value+.1,2),Q()},ye=()=>{F.value=Math.max(F.value-.1,.5),Q()},ve=()=>{F.value=1,Q()},Q=()=>{const t=K.value?.querySelector(".floor-svg");t&&(t.style.transform=`scale(${F.value})`,t.style.transformOrigin="center center")},fe=async()=>{if(j.value)try{await Ie.toCanvas(j.value,"https://museum.example.com/audio-guide/123",{width:200,margin:2,color:{dark:"#000000",light:"#FFFFFF"}})}catch(t){console.error("ÁîüÊàê‰∫åÁª¥Á†ÅÂ§±Ë¥•:",t)}};return Fe(O,t=>{t&&Le(()=>{fe()})}),ze(()=>{b.value?.floors.length>0&&(x.value=0)}),(t,o)=>{const l=p("n-icon"),s=p("n-button"),$=p("n-input"),xe=p("n-scrollbar"),S=p("n-descriptions-item"),J=p("n-tag"),U=p("n-space"),ge=p("n-descriptions"),P=p("n-modal"),_e=p("n-alert"),we=p("n-text"),be=p("n-config-provider");return a(),T(be,{theme:M.value?f(Te):null},{default:i(()=>[r("div",Ke,[r("div",Ge,[r("div",Ze,[n($,{value:g.value,"onUpdate:value":o[0]||(o[0]=e=>g.value=e),placeholder:"ËØ∑ËæìÂÖ•ÊêúÁ¥¢ÂÖ≥ÈîÆËØç",clearable:"",onKeyup:$e(re,["enter"])},{prefix:i(()=>[n(l,{component:f(De)},null,8,["component"])]),suffix:i(()=>[g.value?(a(),T(s,{key:0,text:"",onClick:ce},{default:i(()=>[...o[7]||(o[7]=[h(" ÂèñÊ∂à ",-1)])]),_:1})):V("",!0)]),_:1},8,["value"])]),r("div",Je,[(a(!0),d(k,null,C(te.value,e=>(a(),T(s,{key:e.type,type:_.value===e.type?"primary":"default",size:"small",onClick:v=>ae(e.type)},{icon:i(()=>[r("span",Pe,y(e.icon),1)]),default:i(()=>[h(" "+y(e.label),1)]),_:2},1032,["type","onClick"]))),128))]),r("div",We,[r("div",Xe,[n(s,{text:"",class:"scan-button",onClick:o[1]||(o[1]=e=>O.value=!0)},{icon:i(()=>[n(l,{component:f(Re)},null,8,["component"])]),default:i(()=>[o[8]||(o[8]=h(" Êâ´Á†ÅËÆ≤Ëß£ ",-1))]),_:1}),n(s,{text:"",type:N.value?"primary":"default",class:"map-button",onClick:o[2]||(o[2]=e=>N.value=!N.value)},{icon:i(()=>[n(l,{component:f(Be)},null,8,["component"])]),default:i(()=>[o[9]||(o[9]=h(" Âú∞ÂõæÂØºËßà ",-1))]),_:1},8,["type"])]),r("div",{class:"floor-map-container",ref_key:"mapContainer",ref:K},[r("div",{class:"floor-map-wrapper",style:Oe({height:ee.value+"px"})},[(a(),d("svg",{width:m.value?.svg.width||800,height:m.value?.svg.height||600,viewBox:m.value?.svg.viewBox||"0 0 800 600",class:"floor-svg",onClick:de},[(a(!0),d(k,null,C(m.value?.corridors,e=>(a(),d("g",{key:e.id},[(a(!0),d(k,null,C(e.points.slice(1),(v,I)=>(a(),d("polyline",{key:I,points:`${e.points[I].x},${e.points[I].y} ${v.x},${v.y}`,stroke:M.value?"#666":"#ddd","stroke-width":e.width,fill:"none","stroke-linecap":"round"},null,8,et))),128))]))),128)),(a(!0),d(k,null,C(oe.value,e=>(a(),d("g",{key:e.id},[r("rect",{x:e.x,y:e.y,width:e.width,height:e.height,fill:ue(e.type),stroke:Z(e.type),"stroke-width":"2",class:A({"room-highlight":u.value?.id===e.id}),onClick:W(v=>le(e),["stop"]),style:{cursor:"pointer"}},null,10,tt),r("text",{x:e.x+e.width/2,y:e.y+e.height/2,"text-anchor":"middle","dominant-baseline":"middle",fill:Z(e.type),"font-size":"14","font-weight":"bold","pointer-events":"none"},y(e.name),9,ot)]))),128)),(a(!0),d(k,null,C(ie.value,e=>(a(),d("g",{key:e.id},[r("circle",{cx:e.x,cy:e.y,r:"15",fill:L(e.type),stroke:L(e.type),"stroke-width":"2",class:A({"facility-highlight":_.value===e.type}),onClick:W(v=>se(e),["stop"]),style:{cursor:"pointer"}},null,10,it),r("text",{x:e.x,y:e.y-25,"text-anchor":"middle",fill:L(e.type),"font-size":"18","pointer-events":"none"},y(e.icon),9,nt),r("text",{x:e.x,y:e.y+5,"text-anchor":"middle",fill:L(e.type),"font-size":"10","font-weight":"bold","pointer-events":"none"},y(e.name),9,lt)]))),128))],8,Ye)),r("div",st,[n(s,{size:"small",onClick:me},{icon:i(()=>[n(l,{component:f(qe)},null,8,["component"])]),_:1}),n(s,{size:"small",onClick:ye},{icon:i(()=>[n(l,{component:f(Ve)},null,8,["component"])]),_:1}),n(s,{size:"small",onClick:ve},{icon:i(()=>[n(l,{component:f(Ne)},null,8,["component"])]),_:1})])],4)],512),r("div",at,[n(s,{text:"",size:"small",disabled:x.value===0,onClick:o[3]||(o[3]=e=>G(-1))},{icon:i(()=>[n(l,{component:f(je)},null,8,["component"])]),_:1},8,["disabled"]),n(xe,{style:{"max-height":"400px"}},{default:i(()=>[r("div",rt,[(a(!0),d(k,null,C(b.value?.floors,(e,v)=>(a(),T(s,{key:e.id,type:m.value?.id===e.id?"primary":"default",class:A({"floor-active":m.value?.id===e.id}),onClick:I=>ne(v),block:"",style:{"margin-bottom":"8px"}},{default:i(()=>[h(y(e.name),1)]),_:2},1032,["type","class","onClick"]))),128))])]),_:1}),n(s,{text:"",size:"small",disabled:x.value===(b.value?.floors.length||0)-1,onClick:o[4]||(o[4]=e=>G(1))},{icon:i(()=>[n(l,{component:f(Qe)},null,8,["component"])]),_:1},8,["disabled"])])])]),n(P,{show:q.value,"onUpdate:show":o[5]||(o[5]=e=>q.value=e),preset:"card",style:{width:"600px"},title:"Â±ïÂå∫ËØ¶ÊÉÖ"},{default:i(()=>[u.value?(a(),d("div",ct,[n(U,{vertical:"",size:16},{default:i(()=>[n(ge,{column:1,bordered:""},{default:i(()=>[n(S,{label:"ÂêçÁß∞"},{default:i(()=>[h(y(u.value.name),1)]),_:1}),n(S,{label:"Á±ªÂûã"},{default:i(()=>[n(J,{type:he(u.value.type)},{default:i(()=>[h(y(pe(u.value.type)),1)]),_:1},8,["type"])]),_:1}),n(S,{label:"ÊèèËø∞"},{default:i(()=>[h(y(u.value.description),1)]),_:1}),u.value.exhibits?(a(),T(S,{key:0,label:"Â±ïÂìÅ"},{default:i(()=>[n(U,null,{default:i(()=>[(a(!0),d(k,null,C(u.value.exhibits,(e,v)=>(a(),T(J,{key:v,size:"small"},{default:i(()=>[h(y(e),1)]),_:2},1024))),128))]),_:1})]),_:1})):V("",!0)]),_:1})]),_:1})])):V("",!0)]),_:1},8,["show"]),n(P,{show:O.value,"onUpdate:show":o[6]||(o[6]=e=>O.value=e),preset:"card",style:{width:"400px"},title:"Êâ´Á†ÅËÆ≤Ëß£"},{default:i(()=>[n(U,{vertical:"",size:16},{default:i(()=>[n(_e,{type:"info"},{default:i(()=>[...o[10]||(o[10]=[h(" ËØ∑‰ΩøÁî®ÊâãÊú∫Êâ´ÊèèÂ±ïÂìÅÊóÅÁöÑ‰∫åÁª¥Á†ÅÔºåÂç≥ÂèØÊî∂Âê¨ËØ≠Èü≥ËÆ≤Ëß£„ÄÇ ",-1)])]),_:1}),r("div",dt,[r("canvas",{ref_key:"qrCodeCanvas",ref:j,style:{display:"inline-block"}},null,512),n(we,{depth:"3",style:{display:"block","margin-top":"12px"}},{default:i(()=>[...o[11]||(o[11]=[h(" Á§∫‰æã‰∫åÁª¥Á†Å ",-1)])]),_:1})])]),_:1})]),_:1},8,["show"])])]),_:1},8,["theme"])}}},wt=Me(ut,[["__scopeId","data-v-82abd941"]]);export{wt as default};
